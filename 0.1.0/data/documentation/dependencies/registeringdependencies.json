{"primaryContentSections":[{"kind":"content","content":[{"anchor":"Overview","level":2,"type":"heading","text":"Overview"},{"type":"paragraph","inlineContent":[{"type":"text","text":"Although the library comes with many controllable dependencies out of the box, there are still times"},{"type":"text","text":" "},{"type":"text","text":"when you want to register your own dependencies with the library so that you can use the"},{"type":"text","text":" "},{"type":"reference","isActive":true,"identifier":"doc:\/\/Dependencies\/documentation\/Dependencies\/Dependency"},{"type":"text","text":" property wrapper. Doing this is a two-step process and is quite similar to"},{"type":"text","text":" "},{"type":"text","text":"registering an "},{"type":"reference","isActive":true,"identifier":"https:\/\/developer.apple.com\/documentation\/swiftui\/environmentvalues"},{"type":"text","text":" in SwiftUI."}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"First you create a type that conforms to the "},{"type":"reference","isActive":true,"identifier":"doc:\/\/Dependencies\/documentation\/Dependencies\/DependencyKey"},{"type":"text","text":" protocol. The minimum implementation"},{"type":"text","text":" "},{"type":"text","text":"you must provide is a "},{"type":"reference","isActive":true,"identifier":"doc:\/\/Dependencies\/documentation\/Dependencies\/DependencyKey\/liveValue"},{"type":"text","text":", which is the value used when running the app in a"},{"type":"text","text":" "},{"type":"text","text":"simulator or on device, and so it’s appropriate for it to actually make network requests to an"},{"type":"text","text":" "},{"type":"text","text":"external server:"}]},{"type":"codeListing","syntax":"swift","code":["private enum APIClientKey: DependencyKey {","  static let liveValue = APIClient.live","}"]},{"style":"tip","content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"There are two other values you can provide for a dependency. If you implement"},{"type":"text","text":" "},{"type":"reference","isActive":true,"identifier":"doc:\/\/Dependencies\/documentation\/Dependencies\/DependencyKey\/testValue-5v726"},{"type":"text","text":" it will be used when running features in tests, and if you"},{"type":"text","text":" "},{"type":"text","text":"implement "},{"type":"codeVoice","code":"previewValue"},{"type":"text","text":" it  will be used while running features in an Xcode preview. You don’t"},{"type":"text","text":" "},{"type":"text","text":"need to worry about those values when you are just getting started, and instead can add them"},{"type":"text","text":" "},{"type":"text","text":"later. See "},{"type":"reference","isActive":true,"identifier":"doc:\/\/Dependencies\/documentation\/Dependencies\/LivePreviewTest"},{"type":"text","text":" for more information."}]}],"type":"aside","name":"Tip"},{"type":"paragraph","inlineContent":[{"type":"text","text":"Finally, an extension must be made to "},{"type":"codeVoice","code":"DependencyValues"},{"type":"text","text":" to expose a computed property for the"},{"type":"text","text":" "},{"type":"text","text":"dependency:"}]},{"type":"codeListing","syntax":"swift","code":["extension DependencyValues {","  var apiClient: APIClient {","    get { self[APIClientKey.self] }","    set { self[APIClientKey.self] = newValue }","  }","}"]},{"type":"paragraph","inlineContent":[{"type":"text","text":"With those few steps completed you can instantly access your API client dependency from any part of"},{"type":"text","text":" "},{"type":"text","text":"you code base:"}]},{"type":"codeListing","syntax":"swift","code":["final class TodosModel: ObservableObject {","  @Dependency(\\.apiClient) var apiClient","  \/\/ ...","}"]},{"type":"paragraph","inlineContent":[{"type":"text","text":"This will automatically use the live dependency in previews, simulators and devices, and in tests"},{"type":"text","text":" "},{"type":"text","text":"you can override the dependency to return mock data:"}]},{"type":"codeListing","syntax":"swift","code":["@MainActor","func testFetchUser() async {","  let model = withDependencies {","    $0.apiClient.fetchTodos = { _ in Todo(id: 1, title: \"Get milk\") }","  } operation: {","    TodosModel()","  }","","  await store.loadButtonTapped()","  XCTAssertEqual(","    model.todos,","    [Todo(id: 1, title: \"Get milk\")]","  )","}"]},{"type":"paragraph","inlineContent":[{"type":"text","text":"Often times it is not necessary to create a whole new type to conform to "},{"type":"codeVoice","code":"DependencyKey"},{"type":"text","text":". If the"},{"type":"text","text":" "},{"type":"text","text":"dependency you are registering is a type that you own, then you can conform it directly to the"},{"type":"text","text":" "},{"type":"text","text":"protocol:"}]},{"type":"codeListing","syntax":"swift","code":["extension APIClient: DependencyKey {","  static let liveValue = APIClient.live","}","","extension DependencyValues {","  var apiClient: APIClient {","    get { self[APIClient.self] }","    set { self[APIClient.self] = newValue }","  }","}"]},{"type":"paragraph","inlineContent":[{"type":"text","text":"That can save a little bit of boilerplate."}]}]}],"schemaVersion":{"major":0,"minor":3,"patch":0},"sections":[],"variants":[{"paths":["\/documentation\/dependencies\/registeringdependencies"],"traits":[{"interfaceLanguage":"swift"}]}],"identifier":{"url":"doc:\/\/Dependencies\/documentation\/Dependencies\/RegisteringDependencies","interfaceLanguage":"swift"},"abstract":[{"type":"text","text":"Learn how to register your own dependencies with the library so that they immediately become"},{"type":"text","text":" "},{"type":"text","text":"available from any part of your code base."}],"kind":"article","metadata":{"roleHeading":"Article","title":"Registering dependencies","role":"article","modules":[{"name":"Dependencies"}]},"hierarchy":{"paths":[["doc:\/\/Dependencies\/documentation\/Dependencies"]]},"seeAlsoSections":[{"title":"Essentials","identifiers":["doc:\/\/Dependencies\/documentation\/Dependencies\/UsingDependencies","doc:\/\/Dependencies\/documentation\/Dependencies\/LivePreviewTest"],"generated":true}],"references":{"doc://Dependencies/documentation/Dependencies/DependencyKey/liveValue":{"role":"symbol","title":"liveValue","fragments":[{"kind":"keyword","text":"static"},{"kind":"text","text":" "},{"kind":"keyword","text":"var"},{"kind":"text","text":" "},{"kind":"identifier","text":"liveValue"},{"kind":"text","text":": "},{"kind":"typeIdentifier","text":"Self"},{"kind":"text","text":"."},{"kind":"typeIdentifier","text":"Value"}],"abstract":[{"type":"text","text":"The live value for the dependency key."}],"identifier":"doc:\/\/Dependencies\/documentation\/Dependencies\/DependencyKey\/liveValue","kind":"symbol","required":true,"type":"topic","url":"\/documentation\/dependencies\/dependencykey\/livevalue"},"doc://Dependencies/documentation/Dependencies":{"role":"collection","title":"Dependencies","abstract":[{"type":"text","text":"A dependency management library inspired by SwiftUI’s “environment.”"}],"identifier":"doc:\/\/Dependencies\/documentation\/Dependencies","kind":"symbol","type":"topic","url":"\/documentation\/dependencies"},"doc://Dependencies/documentation/Dependencies/Dependency":{"role":"symbol","title":"Dependency","fragments":[{"kind":"keyword","text":"struct"},{"kind":"text","text":" "},{"kind":"identifier","text":"Dependency"}],"abstract":[{"type":"text","text":"A property wrapper for accessing dependencies."}],"identifier":"doc:\/\/Dependencies\/documentation\/Dependencies\/Dependency","kind":"symbol","type":"topic","navigatorTitle":[{"kind":"identifier","text":"Dependency"}],"url":"\/documentation\/dependencies\/dependency"},"doc://Dependencies/documentation/Dependencies/UsingDependencies":{"role":"article","title":"Using dependencies","abstract":[{"type":"text","text":"Learn how to use the dependencies that are registered with the library."}],"identifier":"doc:\/\/Dependencies\/documentation\/Dependencies\/UsingDependencies","kind":"article","type":"topic","url":"\/documentation\/dependencies\/usingdependencies"},"https://developer.apple.com/documentation/swiftui/environmentvalues":{"title":"environment value","titleInlineContent":[{"type":"text","text":"environment value"}],"type":"link","identifier":"https:\/\/developer.apple.com\/documentation\/swiftui\/environmentvalues","url":"https:\/\/developer.apple.com\/documentation\/swiftui\/environmentvalues"},"doc://Dependencies/documentation/Dependencies/DependencyKey":{"role":"symbol","title":"DependencyKey","fragments":[{"kind":"keyword","text":"protocol"},{"kind":"text","text":" "},{"kind":"identifier","text":"DependencyKey"}],"abstract":[{"type":"text","text":"A key for accessing dependencies."}],"identifier":"doc:\/\/Dependencies\/documentation\/Dependencies\/DependencyKey","kind":"symbol","type":"topic","navigatorTitle":[{"kind":"identifier","text":"DependencyKey"}],"url":"\/documentation\/dependencies\/dependencykey"},"doc://Dependencies/documentation/Dependencies/DependencyKey/testValue-5v726":{"role":"symbol","title":"testValue","fragments":[{"kind":"keyword","text":"static"},{"kind":"text","text":" "},{"kind":"keyword","text":"var"},{"kind":"text","text":" "},{"kind":"identifier","text":"testValue"},{"kind":"text","text":": "},{"kind":"typeIdentifier","text":"Self"},{"kind":"text","text":"."},{"kind":"typeIdentifier","text":"Value"}],"abstract":[{"type":"text","text":"A default implementation that provides the "},{"type":"reference","isActive":true,"identifier":"doc:\/\/Dependencies\/documentation\/Dependencies\/DependencyKey\/liveValue"},{"type":"text","text":" to XCTest runs, but will trigger test"},{"type":"text","text":" "},{"type":"text","text":"failure to occur if accessed."}],"identifier":"doc:\/\/Dependencies\/documentation\/Dependencies\/DependencyKey\/testValue-5v726","kind":"symbol","type":"topic","url":"\/documentation\/dependencies\/dependencykey\/testvalue-5v726"},"doc://Dependencies/documentation/Dependencies/LivePreviewTest":{"role":"article","title":"Live, preview, and test dependencies","abstract":[{"type":"text","text":"Learn how to provide different implementations of your dependencies for use in the live application,"},{"type":"text","text":" "},{"type":"text","text":"as well as in Xcode previews, and even in tests."}],"identifier":"doc:\/\/Dependencies\/documentation\/Dependencies\/LivePreviewTest","kind":"article","type":"topic","url":"\/documentation\/dependencies\/livepreviewtest"}}}